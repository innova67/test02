<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Formulario de registro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx-populate/1.21.0/xlsx-populate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/vfs_fonts.js"></script>
    <!-- <script src="guardar_datos.js"></script> -->
  </head>
  <body>
    <h1>Formulario de registro</h1>
    <form>
      <label for="nombre">Nombre:</label><br>
      <input type="text" id="nombre" name="nombre"><br>
      <label for="modelo">Modelo de teléfono:</label><br>
      <input type="text" id="modelo" name="modelo"><br>
      <label for="identificacion">Número de identificación:</label><br>
      <input type="text" id="identificacion" name="identificacion"><br>
      <label for="fecha">Fecha:</label><br>
      <input type="date" id="fecha" name="fecha"><br>
      <label for="codigoQR">Código QR:</label><br>
      <input type="text" id="codigoQR" name="codigoQR"><br><br>
      <button type="button" onclick="guardarInformacion()">Guardar datos</button>
    </form>
    <div id="descargar"></div>

    <script type="text/javascript">
        function guardarInformacion() {
        // Obtener los datos del formulario
        var nombre = document.getElementById("nombre").value;
        var modelo = document.getElementById("modelo").value;
        var identificacion = document.getElementById("identificacion").value;
        var fecha = document.getElementById("fecha").value;
        var codigoQR = document.getElementById("codigoQR").value;
        
        // Crear objeto con datos a guardar
        const data = { nombre, modelo, identificacion, fecha, codigoQR };

        // Obtener libro de trabajo actual
        const workbook = XlsxPopulate.fromBlankAsync().then(workbook => {

        // Usar la primer hoja del libro de trabajo
        const sheet = workbook.sheet(0);

        // Agregar datos a la hoja
        sheet.cell("A1").value(["Nombre", "Modelo", "Identificación", "Fecha", "Código QR"]);
        //sheet.cell("A2").value(Object.values(data));

        console.log(Object.keys(data));
        console.log(Object.values(data));

        // Descargar archivo
        return workbook.outputAsync()
            .then(function (blob) {
            // Crear un objeto URL para el Blob
            var url = URL.createObjectURL(blob);

            // Crear un enlace para descargar el archivo
            var a = document.createElement("a");
            a.href = url;
            a.download = "informacion.xlsx";
            a.click();

            // Liberar el objeto URL
            URL.revokeObjectURL(url);
            });
        })
        }
    </script>
  </body>
</html>